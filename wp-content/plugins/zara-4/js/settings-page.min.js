!function($){function Zara4_SettingsPage_Ajax(){}Zara4_SettingsPage_Ajax.prototype.constructor=Zara4_SettingsPage_Ajax,Zara4_SettingsPage_Ajax.deleteAllBackups=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"POST",url:ajaxurl,data:{action:"zara4_delete_all_backups"},success:successCallback,error:failureCallback})},Zara4_SettingsPage_Ajax.imagesWithBackups=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"POST",url:ajaxurl,data:{action:"zara4_images_with_backup"},success:successCallback,error:failureCallback})},Zara4_SettingsPage_Ajax.userData=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"GET",url:ZARA4_API_BASE_URL+"/v1/user",data:{access_token:ZARA4_API_ACCESSTOKEN},crossDomain:!0,success:successCallback,error:failureCallback})},Zara4_SettingsPage_Ajax.imageClassificationCount=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"POST",url:ajaxurl,data:{action:"zara4_image_classification_counts"},success:successCallback,error:failureCallback})},Zara4_SettingsPage_Ajax.excludeAllUncompressedImagesFromBulkCompression=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"POST",url:ajaxurl,data:{action:"zara4_exclude_all_uncompressed_images_from_bulk_compression"},success:successCallback,error:failureCallback})},Zara4_SettingsPage_Ajax.includeAllUncompressedImagesInBulkCompression=function(successCallback,failureCallback){successCallback=null!=successCallback?successCallback:function(){},failureCallback=null!=failureCallback?failureCallback:function(){},$.ajax({type:"POST",url:ajaxurl,data:{action:"zara4_include_all_uncompressed_images_in_bulk_compression"},success:successCallback,error:failureCallback})},$.fn.Zara4_SettingsPage_Ajax=Zara4_SettingsPage_Ajax}(jQuery),function($){function Zara4_SettingsPage_Backup(){$("body").append('<div id="zara-4_delete-all-backed-up-images_modal" class="zara-4" style="display: none; width: 640px"><h2>Zara 4 - Delete backed up images</h2><hr/><div class="alert alert-boxed alert-danger"><p>All backed up images will be deleted leaving only the compressed version.</p><p>This will free up storage space on your server but you will not be able to restore images.</p></div><div class="text-center"><p class="zara-4">Are you sure you want to continue?</p></div><div class="text-center mt-15"><span id="zara-4_delete-all-backed-up-images_modal_delete-btn" class="button button-primary">Delete all</span>&nbsp;&nbsp;<a id="zara-4_delete-all-backed-up-images_modal_close-btn" class="button" rel="modal:close">Cancel</a></div></div>'),$("#delete-all-btn").click(function(){$("#zara-4_delete-all-backed-up-images_modal").modal({fadeDuration:200,escapeClose:!1,clickClose:!1,showClose:!1})}),$("#zara-4_delete-all-backed-up-images_modal_delete-btn").click(function(){$.fn.Zara4_SettingsPage_Ajax.deleteAllBackups(function(){Zara4_SettingsPage_Backup.refreshHasBackedUpImagesThatCanBeDeleted()},function(){}),$("#zara-4_delete-all-backed-up-images_modal_close-btn").click()}),Zara4_SettingsPage_Backup.refreshHasBackedUpImagesThatCanBeDeleted(),setTimeout(function(){Zara4_SettingsPage_Backup.refreshHasBackedUpImagesThatCanBeDeleted()},2e4)}Zara4_SettingsPage_Backup.prototype.constructor=Zara4_SettingsPage_Backup,Zara4_SettingsPage_Backup.refreshHasBackedUpImagesThatCanBeDeleted=function(){$.fn.Zara4_SettingsPage_Ajax.imagesWithBackups(function(response){var numberOfBackUpImages=eval(response).length;numberOfBackUpImages>0?($("#delete-all-wrapper .number-of-images").html(numberOfBackUpImages),$("#delete-all-wrapper").slideDown()):$("#delete-all-wrapper").slideUp()},function(){})},$.fn.Zara4_SettingsPage_Backup=Zara4_SettingsPage_Backup}(jQuery),function($){function Zara4_SettingsPage_BulkExclusion(){Zara4_SettingsPage_BulkExclusion.refreshImageClassificationCount(),$("#exclude-all-uncompressed-images").click(function(e){e.preventDefault(),Zara4_SettingsPage_BulkExclusion.excludeAllUncompressedImages()}),$("#include-all-excluded-images").click(function(e){e.preventDefault(),Zara4_SettingsPage_BulkExclusion.includeAllExcludedImages()})}Zara4_SettingsPage_BulkExclusion.prototype.constructor=Zara4_SettingsPage_BulkExclusion,Zara4_SettingsPage_BulkExclusion.refreshImageClassificationCount=function(){$.fn.Zara4_SettingsPage_Ajax.imageClassificationCount(function(response){response=JSON.parse(response);var numberOfCompressedImage=response["number-of-compressed-images"],numberOfUncompressedImage=response["number-of-uncompressed-images"],numberOfExcludedImages=response["number-of-excluded-images"];$("#number-of-compressed-images").html(numberOfCompressedImage),$("#number-of-uncompressed-images").html(numberOfUncompressedImage),$("#number-of-excluded-images").html(numberOfExcludedImages)},function(){})},Zara4_SettingsPage_BulkExclusion.excludeAllUncompressedImages=function(){$.fn.Zara4_SettingsPage_Ajax.excludeAllUncompressedImagesFromBulkCompression(function(){},function(){})},Zara4_SettingsPage_BulkExclusion.includeAllExcludedImages=function(){$.fn.Zara4_SettingsPage_Ajax.includeAllUncompressedImagesInBulkCompression(function(){},function(){})},$.fn.Zara4_SettingsPage_BulkExclusion=Zara4_SettingsPage_BulkExclusion}(jQuery),function($){function Zara4_SettingsPage_DebugInfo(){$("#debug-info-btn").click(function(){$("#zara-4-info-modal").modal({escapeClose:!1,clickClose:!1,showClose:!1})})}Zara4_SettingsPage_DebugInfo.prototype.constructor=Zara4_SettingsPage_DebugInfo,$.fn.Zara4_SettingsPage_DebugInfo=Zara4_SettingsPage_DebugInfo}(jQuery),function($){function Zara4_SettingsPage_Display(){"undefined"==typeof ZARA4_API_ACCESSTOKEN||""==ZARA4_API_ACCESSTOKEN||null==ZARA4_API_ACCESSTOKEN?Zara4_SettingsPage_Display.displayAccountStatusError("Register with Zara 4 to obtain your API credentials. <a target='_blank' href='https://zara4.com/auth/api-register'>Click here</a>"):$.fn.Zara4_SettingsPage_Ajax.userData(function(data,textStatus,jqXHR){data.plan,data["monthly-fee"],data["monthly-quota"],data.usage,data.remaining,data.team,data["is-team-leader"];Zara4_SettingsPage_Display.usedAllQuota(data)?Zara4_SettingsPage_Display.setError("<b>Your quota has run out</b> - <a target='_blank' href='https://zara4.com/account'>upgrade</a> to continue"):Zara4_SettingsPage_Display.quotaIsRunningLow(data)&&Zara4_SettingsPage_Display.setWarning("<b>Your quota is getting low</b> - consider <a target='_blank' href='https://zara4.com/account'>upgrading</a>"),Zara4_SettingsPage_Display.quotaMeteringMethodIsDataUsage(data)?$("#allowance-remaining").html(Zara4_SettingsPage_Display.prettyBytes(Zara4_SettingsPage_Display.totalAllowanceRemaining(data))):$("#allowance-remaining").html(Zara4_SettingsPage_Display.totalAllowanceRemaining(data)),Zara4_SettingsPage_Display.displayAccountStatusOk(),$("#account-usage-wrapper").slideDown(200)},function(){Zara4_SettingsPage_Display.displayAccountStatusError("Invalid API Credentials")})}Zara4_SettingsPage_Display.prototype.constructor=Zara4_SettingsPage_Display,Zara4_SettingsPage_Display.prettyBytes=function(bytes){for(var units=["B","KB","MB","GB","TB","PB"],divisions=0;bytes>=1024;)bytes/=1024,divisions++;return parseFloat(bytes).toFixed(2)+" "+units[divisions]},Zara4_SettingsPage_Display.quotaMeteringMethod=function(data){return data["quota-metering-method"]},Zara4_SettingsPage_Display.quotaMeteringMethodIsDataUsage=function(data){return"data-usage"==Zara4_SettingsPage_Display.quotaMeteringMethod(data)},Zara4_SettingsPage_Display.currentMonthlyPlanIsFree=function(data){return data["monthly-plan"].current.plan.free},Zara4_SettingsPage_Display.totalAllowanceRemaining=function(data){return data.allowances["total-remaining"]},Zara4_SettingsPage_Display.usedAllQuota=function(data){return 0==Zara4_SettingsPage_Display.totalAllowanceRemaining(data)},Zara4_SettingsPage_Display.quotaIsRunningLow=function(data){return Zara4_SettingsPage_Display.currentMonthlyPlanIsFree(data)?Zara4_SettingsPage_Display.totalAllowanceRemaining(data)<5242880:Zara4_SettingsPage_Display.totalAllowanceRemaining(data)<52428800},Zara4_SettingsPage_Display.setWarning=function(warningMessage){$("#warning-message").html(warningMessage).css({display:"inline-block"})},Zara4_SettingsPage_Display.setError=function(errorMessage){$("#error-message").html(errorMessage).css({display:"inline-block"})},Zara4_SettingsPage_Display.displayAccountStatusOk=function(){$("#zara-4-account-status").html("<img src='images/yes.png'/> Looking good")},Zara4_SettingsPage_Display.displayAccountStatusError=function(message){$("#zara-4-account-status").html("<img src='images/no.png'/> "+message)},$.fn.Zara4_SettingsPage_Display=Zara4_SettingsPage_Display}(jQuery),function($){function Zara4_SettingsPage_Register(){$("#google-sign-up").click(function(){Zara4_SettingsPage_Register.googleSignUp()}),$("#facebook-sign-up").click(function(){Zara4_SettingsPage_Register.facebookSignUp()}),$("#github-sign-up").click(function(){Zara4_SettingsPage_Register.githubSignUp()})}Zara4_SettingsPage_Register.prototype.constructor=Zara4_SettingsPage_Register,Zara4_SettingsPage_Register.googleSignUp=function(){var signupWindow=null;window.onmessage=function(e){if(e.origin===Z4_BASE_URL){var data=e.data,clientId=data["client-id"],clientSecret=data["client-secret"];signupWindow.close(),$("#zara4-client-id").val(clientId),$("#zara4-client-secret").val(clientSecret),$("#zara-4-settings-form").submit()}};var uri=Z4_BASE_URL+"/auth/google-login?live-api-clients-for-javascript-window=true&name=WordPress&origin-uri="+window.location.href;signupWindow=window.open(uri,"zara4-signup-google","width=450,height=600")},Zara4_SettingsPage_Register.facebookSignUp=function(){var signupWindow=null;window.onmessage=function(e){if(e.origin===Z4_BASE_URL){var data=e.data,clientId=data["client-id"],clientSecret=data["client-secret"];signupWindow.close(),$("#zara4-client-id").val(clientId),$("#zara4-client-secret").val(clientSecret),$("#zara-4-settings-form").submit()}};var uri=Z4_BASE_URL+"/auth/facebook-login?live-api-clients-for-javascript-window=true&name=WordPress&origin-uri="+window.location.href;signupWindow=window.open(uri,"zara4-signup-facebook","width=450,height=600")},Zara4_SettingsPage_Register.githubSignUp=function(){var signupWindow=null;window.onmessage=function(e){if(e.origin===Z4_BASE_URL){var data=e.data,clientId=data["client-id"],clientSecret=data["client-secret"];signupWindow.close(),$("#zara4-client-id").val(clientId),$("#zara4-client-secret").val(clientSecret),$("#zara-4-settings-form").submit()}};var uri=Z4_BASE_URL+"/auth/github-login?live-api-clients-for-javascript-window=true&name=WordPress&origin-uri="+window.location.href;signupWindow=window.open(uri,"zara4-signup-gihub","width=450,height=600")},$.fn.Zara4_SettingsPage_Register=Zara4_SettingsPage_Register}(jQuery);